<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo da MEME√≥ria</title>

<style>
* {
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family: Arial, sans-serif;
}

body {
  background:#0f172a;
  color:#e5e7eb;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:100vh;
}

h1 {
  margin-bottom:15px;
  color:#22c55e;
}

.top-bar {
  display:flex;
  justify-content:space-between;
  width:95%;
  max-width:520px;
  margin-bottom:15px;
}

.score, .record {
  padding:6px 12px;
  background:#1e293b;
  border-radius:10px;
}

.game-area {
  display:flex;
  flex-direction:column;
  align-items:center;
  width:100%;
}

.card-grid {
  display:grid;
  gap:12px;
  justify-content:center;
  align-items:center;
  perspective:1000px;
  width:100%;
  max-width:100vw;
  padding:10px;
  overflow-x:hidden;
}

/* ===== CARTA ===== */
.card {
  cursor:pointer;
  opacity:0;
  transform:scale(0.6) rotateY(180deg);
  animation: shuffleIn 0.6s ease forwards;
}

@keyframes shuffleIn {
  to {
    opacity:1;
    transform:scale(1) rotateY(0deg);
  }
}

.card-inner {
  width:100%;
  height:100%;
  position:relative;
  transform-style:preserve-3d;
  transition:transform 0.6s;
}

.card.flipped .card-inner,
.card.matched .card-inner {
  transform: rotateY(180deg);
}

.card-front,
.card-back {
  position:absolute;
  width:100%;
  height:100%;
  backface-visibility:hidden;
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  box-shadow:0 8px 15px rgba(0,0,0,0.4);
  border:3px solid #d4af37;
}

.card-front {
  background:linear-gradient(145deg, #1e293b, #0f172a);
  color:#d4af37;
  font-size:12px;
  letter-spacing:1px;
}

.card-back {
  transform: rotateY(180deg);
  background:#22c55e;
  padding:4px;
}

.card-back img {
  width:100%;
  height:100%;
  object-fit:cover;
  border-radius:10px;
}

/* ===== MENUS ===== */
.lobby {
  display:flex;
  flex-direction:column;
  gap:12px;
  margin-bottom:20px;
}

button {
  padding:10px 20px;
  border:none;
  border-radius:10px;
  background:#1e293b;
  color:#e5e7eb;
  cursor:pointer;
}

button:hover {
  background:#22c55e;
  color:#0f172a;
}

.end-menu {
  display:none;
  flex-direction:column;
  gap:10px;
  margin-top:15px;
}

/* üì± Ajustes Mobile */
@media (max-width: 480px){
  .card-grid {
    gap:10px;
  }
  h1 {
    font-size:20px;
  }
}
</style>
</head>

<body>

<h1>Jogo da MEME√≥ria</h1>

<div class="top-bar">
  <div class="score">Pontua√ß√£o: <span id="score">0</span></div>
  <div class="record">Recorde: <span id="record">0</span></div>
</div>

<div class="game-area">

  <div class="lobby" id="lobby">
    <button onclick="setDifficulty('facil')">F√°cil</button>
    <button onclick="setDifficulty('medio')">M√©dio</button>
    <button onclick="setDifficulty('dificil')">Dif√≠cil</button>
    <button onclick="startGame()">Iniciar</button>
  </div>

  <div class="card-grid" id="cardGrid"></div>

  <div class="end-menu" id="endMenu">
    <h2>Fim de Jogo!</h2>
    <button onclick="startGame()">Recome√ßar</button>
  </div>

</div>

<script>
let difficulty = 'facil';
let pairsCount = 8;
let cardSize = { w: 90, h: 130 };

let firstCard = null;
let secondCard = null;
let canFlip = true;

let score = 0;
let comboPoints = 5;
let consecutiveHits = 0;
let consecutiveFails = 0;

const memeImages = [
  "img/meme1.jpg",
  "img/meme2.jpg",
  "img/meme3.jpg",
  "img/meme4.jpg",
  "img/meme5.jpg",
  "img/meme6.jpg",
  "img/meme7.jpg",
  "img/meme8.jpg",
  "img/meme9.jpg"
];

let record = localStorage.getItem("memeoriaRecord") || 0;
document.getElementById("record").innerText = record;

function setDifficulty(level){
  difficulty = level;

  if(level==="facil"){
    pairsCount = 8;
    cardSize = { w: 100, h: 140 };
  }
  if(level==="medio"){
    pairsCount = 12;
    cardSize = { w: 85, h: 120 };
  }
  if(level==="dificil"){
    pairsCount = 16;
    cardSize = { w: 70, h: 100 };
  }
}

function startGame(){
  document.getElementById("lobby").style.display="none";
  document.getElementById("endMenu").style.display="none";

  score = 0;
  comboPoints = 5;
  consecutiveHits = 0;
  consecutiveFails = 0;

  updateScore();
  createCards();
}

function createCards(){
  const grid = document.getElementById("cardGrid");
  grid.innerHTML = "";

  // ==== CONFIGURA√á√ÉO POR DIFICULDADE ====
  let desiredCols = 4;
  let cardW = 90;
  let cardH = 130;

  if (difficulty === "medio") {
    desiredCols = 5;
    cardW = 85;
    cardH = 125;
  }

  if (difficulty === "dificil") {
    desiredCols = 6;
    cardW = 75;
    cardH = 110;
  }

  // ==== CRIA OS PARES ====
  let values = [];
  for (let i = 0; i < pairsCount; i++) {
    values.push(i);
    values.push(i);
  }

  // ==== EMBARALHA ====
  values.sort(() => Math.random() - 0.5);

  // ==== C√ÅLCULO SEGURO DE COLUNAS (SEM CORTAR) ====
  const gap = 14;
  const availableWidth = window.innerWidth - 32;
  const maxColsThatFit = Math.floor(availableWidth / (cardW + gap));

  const cols = Math.min(desiredCols, maxColsThatFit);

  grid.style.gridTemplateColumns = `repeat(${cols}, ${cardW}px)`;

  // ==== CRIA AS CARTAS ====
  values.forEach(value => {
    const card = document.createElement("div");
    card.className = "card";
    card.dataset.value = value;
    card.style.width = cardW + "px";
    card.style.height = cardH + "px";

    card.innerHTML = `
      <div class="card-inner">
        <div class="card-front">MEMEHD8K</div>
        <div class="card-back">
          <img src="${memeImages[value]}" alt="meme">
        </div>
      </div>
    `;

    card.onclick = () => flipCard(card);
    grid.appendChild(card);
  });
}

function flipCard(card){
  if(!canFlip || card.classList.contains("flipped")) return;

  card.classList.add("flipped");

  if(!firstCard){
    firstCard = card;
  } else {
    secondCard = card;
    canFlip = false;

    if(firstCard.dataset.value === secondCard.dataset.value){
      consecutiveHits++;
      consecutiveFails = 0;

      score += comboPoints;
      comboPoints *= (consecutiveHits + 1);

      firstCard.classList.add("matched");
      secondCard.classList.add("matched");

      resetTurn(true);
    } else {
      consecutiveHits = 0;
      comboPoints = 5;
      consecutiveFails++;

      if(consecutiveFails >= 3){
        score -= 5;
        if(score < 0) score = 0;
      }

      setTimeout(()=>resetTurn(false), 900);
    }
    updateScore();
  }
}

function resetTurn(match){
  if(!match){
    firstCard.classList.remove("flipped");
    secondCard.classList.remove("flipped");
  }

  firstCard = null;
  secondCard = null;
  canFlip = true;

  if(document.querySelectorAll(".card:not(.matched)").length === 0){
    document.getElementById("endMenu").style.display="flex";
  }
}

function updateScore(){
  document.getElementById("score").innerText = score;
  if(score > record){
    record = score;
    document.getElementById("record").innerText = record;
    localStorage.setItem("memeoriaRecord", record);
  }
}
</script>

</body>
</html>
