<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo da MEMEória</title>

<style>
* {
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family: Arial, sans-serif;
}

body {
  background:#0f172a;
  color:#e5e7eb;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:100vh;
}

h1 {
  margin-bottom:15px;
  color:#22c55e;
}

.top-bar {
  display:flex;
  justify-content:space-between;
  width:90%;
  max-width:500px;
  margin-bottom:15px;
}

.score, .record {
  padding:6px 12px;
  background:#1e293b;
  border-radius:10px;
}

.game-area {
  display:flex;
  flex-direction:column;
  align-items:center;
}

.card-grid {
  display:grid;
  gap:12px;
  justify-content:center;
  align-items:center;
}

/* CARTAS */
.card {
  width:80px;
  height:110px; /* vertical */
  background:#1e293b;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  font-weight:bold;
  font-size:13px;
  color:#22c55e;
  overflow:hidden;
}

.card.flipped,
.card.matched {
  background:#22c55e;
  cursor:default;
}

.card img {
  width:100%;
  height:100%;
  object-fit:cover;
}

/* MENUS */
.lobby {
  display:flex;
  flex-direction:column;
  gap:12px;
  margin-bottom:20px;
}

button {
  padding:10px 20px;
  border:none;
  border-radius:10px;
  background:#1e293b;
  color:#e5e7eb;
  cursor:pointer;
}

button:hover {
  background:#22c55e;
  color:#0f172a;
}

.end-menu {
  display:none;
  flex-direction:column;
  gap:10px;
  margin-top:15px;
}
</style>
</head>

<body>

<h1>Jogo da MEMEória</h1>

<div class="top-bar">
  <div class="score">Pontuação: <span id="score">0</span></div>
  <div class="record">Recorde: <span id="record">0</span></div>
</div>

<div class="game-area">

  <div class="lobby" id="lobby">
    <button onclick="setDifficulty('facil')">Fácil</button>
    <button onclick="setDifficulty('medio')">Médio</button>
    <button onclick="setDifficulty('dificil')">Difícil</button>
    <button onclick="startGame()">Iniciar</button>
  </div>

  <div class="card-grid" id="cardGrid"></div>

  <div class="end-menu" id="endMenu">
    <h2>Fim de Jogo!</h2>
    <button onclick="startGame()">Recomeçar</button>
  </div>

</div>

<script>
let difficulty = 'facil';
let pairsCount = 8;
let firstCard = null;
let secondCard = null;
let canFlip = true;

let score = 0;
let comboPoints = 5;
let consecutiveHits = 0;
let consecutiveFails = 0;

const memeImages = [
  "img/meme1.jpg",
  "img/meme2.jpg",
  "img/meme3.jpg",
  "img/meme4.jpg",
  "img/meme5.jpg",
  "img/meme6.jpg",
  "img/meme7.jpg",
  "img/meme8.jpg",
  "img/meme9.jpg"
];

let record = localStorage.getItem("memeoriaRecord") || 0;
document.getElementById("record").innerText = record;

function setDifficulty(level){
  difficulty = level;
  if(level==="facil") pairsCount = 8;
  if(level==="medio") pairsCount = 12;
  if(level==="dificil") pairsCount = 16;
}

function startGame(){
  document.getElementById("lobby").style.display="none";
  document.getElementById("endMenu").style.display="none";
  score = 0;
  comboPoints = 5;
  consecutiveHits = 0;
  consecutiveFails = 0;
  updateScore();
  createCards();
}

function createCards(){
  const grid = document.getElementById("cardGrid");
  grid.innerHTML = "";

  let values = [];
  for(let i=0;i<pairsCount;i++){
    values.push(i);
    values.push(i);
  }
  values.sort(()=>Math.random()-0.5);

  let cols = Math.sqrt(values.length);
  grid.style.gridTemplateColumns = `repeat(${cols}, 80px)`;

  values.forEach(value=>{
    const card = document.createElement("div");
    card.className = "card";
    card.dataset.value = value;
    card.innerText = "MEMEHD8K";
    card.onclick = ()=>flipCard(card);
    grid.appendChild(card);
  });
}

function flipCard(card){
  if(!canFlip || card.classList.contains("flipped")) return;

  card.classList.add("flipped");
  card.innerHTML = `<img src="${memeImages[card.dataset.value]}">`;

  if(!firstCard){
    firstCard = card;
  } else {
    secondCard = card;
    canFlip = false;

    if(firstCard.dataset.value === secondCard.dataset.value){
      // ACERTO
      consecutiveHits++;
      consecutiveFails = 0;

      score += comboPoints;
      comboPoints *= (consecutiveHits + 1);

      resetTurn(true);
    } else {
      // ERRO
      consecutiveHits = 0;
      comboPoints = 5;
      consecutiveFails++;

      if(consecutiveFails >= 3){
        score -= 5;
        if(score < 0) score = 0;
      }

      setTimeout(()=>{
        resetTurn(false);
      },1000);
    }

    updateScore();
  }
}

function resetTurn(match){
  if(!match){
    firstCard.classList.remove("flipped");
    secondCard.classList.remove("flipped");
    firstCard.innerText = "MEMEHD8K";
    secondCard.innerText = "MEMEHD8K";
  }

  firstCard = null;
  secondCard = null;
  canFlip = true;

  if(document.querySelectorAll(".card:not(.flipped)").length === 0){
    document.getElementById("endMenu").style.display="flex";
  }
}

function updateScore(){
  document.getElementById("score").innerText = score;
  if(score > record){
    record = score;
    document.getElementById("record").innerText = record;
    localStorage.setItem("memeoriaRecord", record);
  }
}
</script>

</body>
</html>
